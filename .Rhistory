subtitle = 'Top 5 Medals Own Countries',
x= 'Age',
y='')
#Gender Distribution
historical %>%
filter(Year == 2020) %>%
filter(Team == "United States of America" | Team == "People's Republic of China"|Team == "RPC"|Team == "Great Britain"|Team == "Japan")%>%
ggplot(aes(x=Sex,fill = Team))+
geom_count(alpha = 0.7)+
labs(title = 'Distribution of Age for all Athletes',
subtitle = 'Top 5 Medals Own Countries',
x= 'Age',
y='')
#Athletes Age distribution for Top5 medal countries in Tokyo
historical %>%
filter(Year == 2020) %>%
filter(Team == "United States of America" | Team == "People's Republic of China"|Team == "RPC"|Team == "Great Britain"|Team == "Japan")%>%
ggplot(aes(x=Age,fill = Team))+
geom_density(alpha = 0.7)+
labs(title = 'Distribution of Age for all Athletes',
subtitle = 'Top 5 Medals Own Countries',
x= 'Age',
y='')
historical %>%
filter(Medal >0, Year == 2020) %>%
filter(Team == "United States of America" | Team == "People's Republic of China"|Team == "RPC"|Team == "Great Britain"|Team == "Japan")%>%
ggplot(aes(x=Age,fill = Team))+
geom_crossbar(alpha = 0.7)+
labs(title = 'Distribution of Age for Medal Winners',
subtitle = 'Top 5 Medals Win Countries',
x= 'Age',
y='')+
ylim(0,200)
#Athletes Age distribution for Top5 medal countries in Tokyo
historical %>%
filter(Year == 2020) %>%
filter(Team == "United States of America" | Team == "People's Republic of China"|Team == "RPC"|Team == "Great Britain"|Team == "Japan")%>%
ggplot(aes(x=Age,fill = Team))+
geom_density(alpha = 0.7)+
labs(title = 'Distribution of Age for all Athletes',
subtitle = 'Top 5 Medals Own Countries',
x= 'Age',
y='')
historical %>%
filter(Medal >0, Year == 2020) %>%
filter(Team == "United States of America" | Team == "People's Republic of China"|Team == "RPC"|Team == "Great Britain"|Team == "Japan")%>%
ggplot(aes(x=Age,fill = Team))+
geom_boxplot(alpha = 0.7)+
labs(title = 'Distribution of Age for Medal Winners',
subtitle = 'Top 5 Medals Win Countries',
x= 'Age',
y='')+
ylim(0,200)
#Athletes Age distribution for Top5 medal countries in Tokyo
historical %>%
filter(Year == 2020) %>%
filter(Team == "United States of America" | Team == "People's Republic of China"|Team == "RPC"|Team == "Great Britain"|Team == "Japan")%>%
ggplot(aes(x=Age,fill = Team))+
geom_density(alpha = 0.7)+
labs(title = 'Distribution of Age for all Athletes',
subtitle = 'Top 5 Medals Own Countries',
x= 'Age',
y='')
historical %>%
filter(Medal >0, Year == 2020) %>%
filter(Team == "United States of America" | Team == "People's Republic of China"|Team == "RPC"|Team == "Great Britain"|Team == "Japan")%>%
ggplot(aes(x=Age,fill = Team))+
geom_boxplot(alpha = 0.7)+
labs(title = 'Distribution of Age for Medal Winners',
subtitle = 'Top 5 Medals Win Countries',
x= 'Age',
y='')
#Athletes Age distribution for Top5 medal countries in Tokyo
historical %>%
filter(Year == 2020) %>%
filter(Team == "United States of America" | Team == "People's Republic of China"|Team == "RPC"|Team == "Great Britain"|Team == "Japan")%>%
ggplot(aes(x=Age,fill = Team))+
geom_boxplot(alpha = 0.7)+
labs(title = 'Distribution of Age for all Athletes',
subtitle = 'Top 5 Medals Own Countries',
x= 'Age',
y='')
historical %>%
filter(Medal >0, Year == 2020) %>%
filter(Team == "United States of America" | Team == "People's Republic of China"|Team == "RPC"|Team == "Great Britain"|Team == "Japan")%>%
ggplot(aes(x=Age,fill = Team))+
geom_boxplot(alpha = 0.7)+
labs(title = 'Distribution of Age for Medal Winners',
subtitle = 'Top 5 Medals Win Countries',
x= 'Age',
y='')
#Athletes Age distribution for Top5 medal countries in Tokyo
historical %>%
filter(Year == 2020) %>%
filter(Team == "United States of America" | Team == "People's Republic of China"|Team == "RPC"|Team == "Great Britain"|Team == "Japan")%>%
ggplot(aes(x=Age,fill = Team))+
geom_boxplot(alpha = 0.7)+
labs(title = 'Distribution of Age for all Athletes',
subtitle = 'Top 5 Medals Own Countries',
x= 'Age',
y='')
historical %>%
filter(Medal >0, Year == 2020) %>%
filter(Team == "United States of America" | Team == "People's Republic of China"|Team == "RPC"|Team == "Great Britain"|Team == "Japan")%>%
ggplot(aes(x=Age,fill = Team))+
geom_boxplot(alpha = 0.7)+
labs(title = 'Distribution of Age for Medal Winners',
subtitle = 'Top 5 Medals Win Countries',
x= 'Age')
#Athletes Age distribution for Top5 medal countries in Tokyo
historical %>%
filter(Year == 2020) %>%
filter(Team == "United States of America" | Team == "People's Republic of China"|Team == "RPC"|Team == "Great Britain"|Team == "Japan")%>%
ggplot(aes(x=Age,fill = Team))+
geom_density(alpha = 0.7)+
labs(title = 'Distribution of Age for all Athletes',
subtitle = 'Top 5 Medals Own Countries',
x= 'Age',
y='')
historical %>%
filter(Medal >0, Year == 2020) %>%
filter(Team == "United States of America" | Team == "People's Republic of China"|Team == "RPC"|Team == "Great Britain"|Team == "Japan")%>%
ggplot(aes(x=Age,fill = Team))+
geom_boxplot(alpha = 0.7)+
labs(title = 'Distribution of Age for Medal Winners',
subtitle = 'Top 5 Medals Win Countries',
x= 'Age',
y='')+
ylim(0,200)
#Athletes Age distribution for Top5 medal countries in Tokyo
historical %>%
filter(Year == 2020) %>%
filter(Team == "United States of America" | Team == "People's Republic of China"|Team == "RPC"|Team == "Great Britain"|Team == "Japan")%>%
ggplot(aes(x=Age,fill = Team))+
geom_density(alpha = 0.7)+
labs(title = 'Distribution of Age for all Athletes',
subtitle = 'Top 5 Medals Own Countries',
x= 'Age',
y='')
historical %>%
filter(Medal >0, Year == 2020) %>%
filter(Team == "United States of America" | Team == "People's Republic of China"|Team == "RPC"|Team == "Great Britain"|Team == "Japan")%>%
ggplot(aes(x=Age,fill = Team))+
geom_dotplot(alpha = 0.7)+
labs(title = 'Distribution of Age for Medal Winners',
subtitle = 'Top 5 Medals Win Countries',
x= 'Age',
y='')+
ylim(0,200)
#Gender Distribution
historical %>%
filter(Year == 2020) %>%
filter(Team == "United States of America" | Team == "People's Republic of China"|Team == "RPC"|Team == "Great Britain"|Team == "Japan")%>%
ggplot(aes(x=Sex,fill = Team))+
geom_boxplot(alpha = 0.7)+
labs(title = 'Distribution of Age for all Athletes',
subtitle = 'Top 5 Medals Own Countries',
x= 'Age',
y='')
#Gender Distribution
historical %>%
filter(Year == 2020) %>%
filter(Team == "United States of America" | Team == "People's Republic of China"|Team == "RPC"|Team == "Great Britain"|Team == "Japan")%>%
ggplot(aes(x=Team, y=Sex,fill = Team))+
geom_boxplot(alpha = 0.7)+
labs(title = 'Distribution of Age for all Athletes',
subtitle = 'Top 5 Medals Own Countries',
x= 'Age',
y='')
#Gender Distribution
historical %>%
filter(Year == 2020) %>%
filter(Team == "United States of America" | Team == "People's Republic of China"|Team == "RPC"|Team == "Great Britain"|Team == "Japan")%>%
count(Sex, sort = Team) %>%
ggplot(aes(x=Sex,fill = Team))+
geom_boxplot(alpha = 0.7)+
labs(title = 'Distribution of Age for all Athletes',
subtitle = 'Top 5 Medals Own Countries',
x= 'Age',
y='')
#Gender Distribution
historical %>%
filter(Year == 2020) %>%
filter(Team == "United States of America" | Team == "People's Republic of China"|Team == "RPC"|Team == "Great Britain"|Team == "Japan")%>%
group_by(Team)
#Gender Distribution
historical %>%
filter(Year == 2020) %>%
filter(Team == "United States of America" | Team == "People's Republic of China"|Team == "RPC"|Team == "Great Britain"|Team == "Japan")%>%
group_by(Team) %>%
sum(count=n(Sex))
#Gender Distribution
historical %>%
filter(Year == 2020) %>%
filter(Team == "United States of America" | Team == "People's Republic of China"|Team == "RPC"|Team == "Great Britain"|Team == "Japan")%>%
group_by(Team) %>%
sum(count=n("Sex"))
#Gender Distribution
historical %>%
filter(Year == 2020) %>%
filter(Team == "United States of America" | Team == "People's Republic of China"|Team == "RPC"|Team == "Great Britain"|Team == "Japan")%>%
group_by(Team) %>%
sum(count=n()))
#Gender Distribution
historical %>%
filter(Year == 2020) %>%
filter(Team == "United States of America" | Team == "People's Republic of China"|Team == "RPC"|Team == "Great Britain"|Team == "Japan")%>%
group_by(Team)
#Gender Distribution
historical %>%
filter(Year == 2020) %>%
filter(Team == "United States of America" | Team == "People's Republic of China"|Team == "RPC"|Team == "Great Britain"|Team == "Japan")%>%
group_by(Team) %>%
sum(Sex)
#Gender Distribution
historical %>%
filter(Year == 2020) %>%
filter(Team == "United States of America" | Team == "People's Republic of China"|Team == "RPC"|Team == "Great Britain"|Team == "Japan")%>%
group_by(Team) %>%
sum(Sex, na.rm=TRUE)
#Gender Distribution
historical %>%
filter(Year == 2020) %>%
filter(Team == "United States of America" | Team == "People's Republic of China"|Team == "RPC"|Team == "Great Britain"|Team == "Japan")%>%
group_by(Team, Sex)
#Gender Distribution
historical %>%
filter(Year == 2020) %>%
filter(Team == "United States of America" | Team == "People's Republic of China"|Team == "RPC"|Team == "Great Britain"|Team == "Japan")%>%
group_by(Team)
#Gender Distribution
historical %>%
filter(Year == 2020) %>%
filter(Team == "United States of America" | Team == "People's Republic of China"|Team == "RPC"|Team == "Great Britain"|Team == "Japan")%>%
group_by(Sex) %>%
count=n()
#Gender Distribution
historical %>%
filter(Year == 2020) %>%
filter(Team == "United States of America" | Team == "People's Republic of China"|Team == "RPC"|Team == "Great Britain"|Team == "Japan")%>%
group_by(Team) %>%
count=n()
#Gender Distribution
historical %>%
filter(Year == 2020) %>%
filter(Team == "United States of America" | Team == "People's Republic of China"|Team == "RPC"|Team == "Great Britain"|Team == "Japan")%>%
group_by(Team) %>%
sum(count=n())
#Gender Distribution
historical %>%
filter(Year == 2020) %>%
filter(Team == "United States of America" | Team == "People's Republic of China"|Team == "RPC"|Team == "Great Britain"|Team == "Japan")%>%
group_by(Team) %>%
summarize(count=n())
#Gender Distribution
historical %>%
filter(Year == 2020) %>%
filter(Team == "United States of America" | Team == "People's Republic of China"|Team == "RPC"|Team == "Great Britain"|Team == "Japan")%>%
group_by(Team) %>%
summarize_at(c("F", "M")
#Gender Distribution
historical %>%
filter(Year == 2020) %>%
filter(Team == "United States of America" | Team == "People's Republic of China"|Team == "RPC"|Team == "Great Britain"|Team == "Japan")%>%
group_by(Team) %>%
summarize_at(c("Female", "Male")
#Gender Distribution
historical %>%
filter(Year == 2020) %>%
filter(Team == "United States of America" | Team == "People's Republic of China"|Team == "RPC"|Team == "Great Britain"|Team == "Japan")%>%
group_by(Team) %>%
summarize_at(c("F", "M")
#Gender Distribution
historical %>%
filter(Year == 2020) %>%
filter(Team == "United States of America" | Team == "People's Republic of China"|Team == "RPC"|Team == "Great Britain"|Team == "Japan")%>%
group_by(Team) %>%
Count(Sex)
#Gender Distribution
historical %>%
filter(Year == 2020) %>%
filter(Team == "United States of America" | Team == "People's Republic of China"|Team == "RPC"|Team == "Great Britain"|Team == "Japan")%>%
group_by(Team) %>%
count(Sex)
#Gender Distribution
historical %>%
filter(Year == 2020) %>%
filter(Team == "United States of America" | Team == "People's Republic of China"|Team == "RPC"|Team == "Great Britain"|Team == "Japan")%>%
group_by(Team) %>%
count(Sex)
#Gender Distribution
his <- historical %>%
filter(Year == 2020) %>%
filter(Team == "United States of America" | Team == "People's Republic of China"|Team == "RPC"|Team == "Great Britain"|Team == "Japan")%>%
group_by(Team) %>%
count(Sex)
ggplot(his)+geom_bar(aes(x=cut, fill=cut))+coord_flip()
#Gender Distribution
his <- historical %>%
filter(Year == 2020) %>%
filter(Team == "United States of America" | Team == "People's Republic of China"|Team == "RPC"|Team == "Great Britain"|Team == "Japan")%>%
group_by(Team) %>%
count(Sex)
ggplot(his, )+geom_bar(aes(x=Sex, fill=Team))+coord_flip()
#Gender Distribution
his <- historical %>%
filter(Year == 2020) %>%
filter(Team == "United States of America" | Team == "People's Republic of China"|Team == "RPC"|Team == "Great Britain"|Team == "Japan")%>%
group_by(Team) %>%
count(Sex)
ggplot(his, )+geom_bar(aes(x=Sex, fill=Team))+coord_polar(theta="y")
#Gender Distribution
his <- historical %>%
filter(Year == 2020) %>%
filter(Team == "United States of America" | Team == "People's Republic of China"|Team == "RPC"|Team == "Great Britain"|Team == "Japan")%>%
group_by(Team) %>%
count(Sex)
ggplot(his, aes(x=Team, y=Sex),color=variable)+
geom_boxplot() +
theme(axis.text.x=element_text(angle=50,hjust=0.5, vjust=0.5)) +
theme(legend.position="none")
#Gender Distribution
his <- historical %>%
filter(Year == 2020) %>%
filter(Team == "United States of America" | Team == "People's Republic of China"|Team == "RPC"|Team == "Great Britain"|Team == "Japan")%>%
group_by(Team) %>%
count(Sex)
ggplot(historical, aes(x=Team, y=Sex),color=variable)+
geom_boxplot() +
theme(axis.text.x=element_text(angle=50,hjust=0.5, vjust=0.5)) +
theme(legend.position="none")
#Gender Distribution
his <- historical %>%
filter(Year == 2020) %>%
filter(Team == "United States of America" | Team == "People's Republic of China"|Team == "RPC"|Team == "Great Britain"|Team == "Japan")
ggplot(historical, aes(x=Team, y=Sex),color=variable)+
geom_boxplot() +
theme(axis.text.x=element_text(angle=50,hjust=0.5, vjust=0.5)) +
theme(legend.position="none")
#Gender Distribution
his <- historical %>%
filter(Year == 2020) %>%
filter(Team == "United States of America" | Team == "People's Republic of China"|Team == "RPC"|Team == "Great Britain"|Team == "Japan")
ggplot(his, aes(x=Team, y=Sex),color=variable)+
geom_boxplot() +
theme(axis.text.x=element_text(angle=50,hjust=0.5, vjust=0.5)) +
theme(legend.position="none")
#Gender Distribution
his <- historical %>%
filter(Year == 2020) %>%
filter(Team == "United States of America" | Team == "People's Republic of China"|Team == "RPC"|Team == "Great Britain"|Team == "Japan")
ggplot(his, aes(Sex, Team),color=variable)+
geom_boxplot() +
theme(axis.text.x=element_text(angle=50,hjust=0.5, vjust=0.5)) +
theme(legend.position="none")
#Gender Distribution
his <- historical %>%
filter(Year == 2020) %>%
filter(Team == "United States of America" | Team == "People's Republic of China"|Team == "RPC"|Team == "Great Britain"|Team == "Japan")
ggplot(his, aes(Sex, Team),color=variable)+
geom_line(aes(group=district))+
geom_point(shape=21,size=3.5,colour="darkgray")
#Gender Distribution
his <- historical %>%
filter(Year == 2020) %>%
filter(Team == "United States of America" | Team == "People's Republic of China"|Team == "RPC"|Team == "Great Britain"|Team == "Japan")
ggplot(his, aes(Sex, Team),color=variable)+
geom_line(aes(group=Sex))+
geom_point(shape=21,size=3.5,colour="darkgray")
#Gender Distribution
his <- historical %>%
filter(Year == 2020) %>%
filter(Team == "United States of America" | Team == "People's Republic of China"|Team == "RPC"|Team == "Great Britain"|Team == "Japan")
ggplot(his, aes(Sex, Team),color=variable)+
geom_line(aes(group=Team))+
geom_point(shape=21,size=3.5,colour="darkgray")
#Gender Distribution
his <- historical %>%
filter(Year == 2020) %>%
filter(Team == "United States of America" | Team == "People's Republic of China"|Team == "RPC"|Team == "Great Britain"|Team == "Japan")%>%
group_by(Team) %>%
count(Sex)
ggplot(historical, aes(x=Team, y=Sex),color=variable)+
geom_line(aes(group=Team))+
geom_point(shape=21,size=3.5,colour="darkgray")
#Gender Distribution
his <- historical %>%
filter(Year == 2020) %>%
filter(Team == "United States of America" | Team == "People's Republic of China"|Team == "RPC"|Team == "Great Britain"|Team == "Japan")%>%
group_by(Team) %>%
count(Sex)
ggplot(his, aes(x=Team, y=Sex),color=variable)+
geom_line(aes(group=Team))+
geom_point(shape=21,size=3.5,colour="darkgray")
#Gender Distribution
his <- historical %>%
filter(Year == 2020) %>%
filter(Team == "United States of America" | Team == "People's Republic of China"|Team == "RPC"|Team == "Great Britain"|Team == "Japan")%>%
group_by(Team) %>%
count(Sex)
his <- historical %>%
filter(Year == 2020) %>%
filter(Team == "United States of America" | Team == "People's Republic of China"|Team == "RPC"|Team == "Great Britain"|Team == "Japan")%>%
group_by(Team) %>%
count(Sex)
#Gender Distribution
his <- historical %>%
filter(Year == 2020) %>%
filter(Team == "United States of America" | Team == "People's Republic of China"|Team == "RPC"|Team == "Great Britain"|Team == "Japan")%>%
group_by(Team) %>%
count(Sex)
ggplot(his, aes(x=Team, y=Sex),color=variable)+
geom_line(aes(group=Team))+
geom_point(shape=21,size=3.5,colour="darkgray")
#Gender Distribution
his <- historical %>%
filter(Year == 2020) %>%
filter(Team == "United States of America" | Team == "People's Republic of China"|Team == "RPC"|Team == "Great Britain"|Team == "Japan")%>%
group_by(Team) %>%
count(Sex)
#Gender Distribution
his <- historical %>%
filter(Year == 2020) %>%
filter(Team == "United States of America" | Team == "People's Republic of China"|Team == "RPC"|Team == "Great Britain"|Team == "Japan")%>%
group_by(Team) %>%
count(Sex)
#Data setup
library(readxl)
library(tidyverse)
library(ggplot2)
library(dplyr)
library(colorspace)
library(RColorBrewer)
library(ggthemes)
library(forcats)
athletes <- read_excel("data/Athletes.xlsx")
gender <- read_excel("data/EntriesGender.xlsx")
medals <- read_excel("data/Medals.xlsx")
coaches <- read_excel("data/Coaches.xlsx")
historical <- read_csv("data/All Year Olympic Dataset (with 2020 Tokyo Olympics).csv")
#Top 10 number of athletes by country
athletes %>%
count(NOC, sort = TRUE) %>%
slice(1:10) %>%
group_by(NOC) %>%
ggplot(aes(x=reorder(NOC, desc(n)), y=n, fill = n)) +
geom_col(color = "black") +
labs(title = "Top 10 Countries by the Number of Athletes", x= "Countries",
y = "Number of Athletes", subtitle = "Number of Athelets")+
theme(axis.text.x = element_text(size = 8, color = "red", face = "bold.italic", angle = 50, hjust = 1),
axis.title.y = element_text( size = 8, color = "red", face = "bold.italic"))+
ylim(c(0, 1000))+
geom_text(mapping = aes(label = n, size = 12, color = "red", face = "bold.italic", vjust = -1))+
theme(legend.position = "none")
# Numbers of athelets v.s. Number of Coaches
medals_break_country <- medals %>%
rename(country = 'Team/NOC',
rank = 'Rank by Total') %>%
pivot_longer(Gold:Bronze,names_to = "medal",
values_to = "number_of_medal") %>%
transform(number_of_medal = as.numeric(number_of_medal),
Total = as.numeric(Total),
rank = as.numeric(rank))  %>%
arrange(rank) %>%
slice(1:15)
ggplot(medals_break_country,aes(reorder(country,number_of_medal),
number_of_medal,
fill = factor(medal, levels = c("Bronze","Silver","Gold")))) +
geom_col(col="black") +
labs(fill = "Type of medal",
y="Number of medal (Medal)",
x="Country",
title='Number of medals breakdown by country',
subtitle='Top 5') +
coord_flip() +
theme(plot.title = element_text(hjust=0.5,size=16),
axis.text.x = element_text(size=12),
axis.text.y = element_text(size=12),
axis.title = element_text(size=12),
plot.subtitle = element_text(hjust=0.5,size=8)) +
ylim(0,120)
#Athletes Age distribution for Top5 medal countries in Tokyo
historical %>%
filter(Year == 2020) %>%
filter(Team == "United States of America" | Team == "People's Republic of China"|Team == "RPC"|Team == "Great Britain"|Team == "Japan")%>%
ggplot(aes(x=Age,fill = Team))+
geom_density(alpha = 0.7)+
labs(title = 'Distribution of Age for all Athletes',
subtitle = 'Top 5 Medals Own Countries',
x= 'Age',
y='')
historical %>%
filter(Medal >0, Year == 2020) %>%
filter(Team == "United States of America" | Team == "People's Republic of China"|Team == "RPC"|Team == "Great Britain"|Team == "Japan")%>%
ggplot(aes(x=Age,fill = Team))+
geom_dotplot(alpha = 0.7)+
labs(title = 'Distribution of Age for Medal Winners',
subtitle = 'Top 5 Medals Win Countries',
x= 'Age',
y='')+
ylim(0,200)
#Gender Distribution
his <- historical %>%
filter(Year == 2020) %>%
filter(Team == "United States of America" | Team == "People's Republic of China"|Team == "RPC"|Team == "Great Britain"|Team == "Japan")%>%
group_by(Team) %>%
count(Sex)
his <- historical %>%
filter(Year == 2020) %>%
filter(Team == "United States of America" | Team == "People's Republic of China"|Team == "RPC"|Team == "Great Britain"|Team == "Japan")%>%
group_by(Team) %>%
count(Sex)
